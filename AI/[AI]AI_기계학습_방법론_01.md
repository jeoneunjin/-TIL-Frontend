# 🤖 AI & 기계학습 방법론(1)

## 📚 목차

---

## 1. 선형회귀(Linear Regression)

> 입력 변수와 출력 변수 사이의 관계를 직선 형태로 근사하여 예측하는 통계적 방법

- 선형회귀를 통해 알 수 있는 예시:
  - 광고비와 매출 사이에 관계가 있는가?
  - 그 관계의 강도는 어느 정도?
  - 어떤 매체가 매출에 기여하는가?

---

## 2. 단순선형회귀(Simple Linear Regression)

## 2-1. 단일 설명변수를 이용한 선형회귀

> 한 개의 **설명변수(X)**와 하나의 **반응변수(Y)** 사이의 **선형(직선) 관계**를 찾는 방법

- 목표 : 데이터를 가장 잘 설명하는 직선을 찾아 예측에 활용
- 단일 설명변수를 이용한 단순선형회귀
  - 모형 가정 : `Y = b0 + b1X + E`
  - b0 : 절편(X=0일 때의 Y 값)
  - b1 : 기울기(X가 1단위 증가할 때 Y의 평균 증가량)
  - E : 관측 오차

## 2-2. 최소제곱법(least squares)

> **실제 관측값과 예측값의 차이**(잔차, residual)를 제곱해 합한 값(RSS, **잔차제곱합**)을 최소화하는 방법
> RSS = (실제값-예측값)\*\*2의 합(이때 잔차는 n(데이터 개수만큼)개 나옴)

- 목표 : 데이터를 가장 잘 설명하는(=RSS를 최소화하는) 직선을 찾기 위해 b0, b1을 추정
- **closed-form solution**
  > 공식으로 바로 계산할 수 있는 해가 존재함!

## 2-3. 광고 데이터

## 3. 다중선형회귀(multiple linear regression)

## 3-1. 다중선형회귀란?

> 독립 변수(설명 변수, Feature)가 여러 개 존재할 때 사용하는 회귀 분석 기법

- 여러 독립 변수를 동시에 고려하여, 종속변수 Y와의 관계를 구함

- 모형 가정 : `Y = b0 + b1X1 + b2X2 + ... + BpXp + E`
- b1, b2...bp : 각 독립 변수에 대한 회귀 계수(모수) = 번수의 영향력 크기와 뱡향을 나타냄

## 3-2. 다중선형회귀의 추정과 예측

> 단위선형회귀와 마찬가지로 최소제곱법으로 RSS를 최소화

- 여러 입력 변수를 동시에 고려하여 데이터와 가장 가까운 평면(hyperplane)을 찾는 과정

## 3-3. 다중선형회귀 계수 추정 유도(행렬 표현)

## 3-4. 다중선형회귀 시각화

## 3-5. 다중선형회귀 결과: 광고데이터

---

## 4. 선형회귀 주의사항

## 4-1. 검증/테스트셋 데이터를 활용한 성능 평가

- 훈련 데이터에서의 성능
- 테스트 성능 평가 필요

## 4-2. 다중선형회귀시 회귀계수 해석의 주의점

- 이상적 상황: 변수들이 연관되지 않고, 독립적일 때 -> 계수 해석이 명확함
- 문제 상황: 변수들이 서로 연관되어 있다면 -> 계수 추정이 불안정해지고 해석에 혼동이 발생할 수 있음
- 주의 : 관찰 데이터의 상관관계로 인과 관계를 주장해서는 안 됨
  **상관관계 != 인과관계**

---

## 1. 분류(Classification)

## 1-1. 분류란?

> 정해진 범주(카테고리) 중 하나로 지정하는 것

- 범주형 변수 : 수치의 크고 작음이 아니라 유한한 점주(성별, 혈액형, 지역 등)로 표현하는 변수
- 분류 함수의 목표 : 분류 함수 f(x)를 학습하여 입력 X가 속할 범주(카테고리)를 예측

## 1-2. 예시 : 신용카드 연체(Default)

- 신용카드 사용량 및 소득에 대한 연체 여부 산점도

  - 신용카드 사용량(Balance) - 소득(Income) 산점도에 연체(Default) 여부를 색상(주황색 vs 파란색) 및 부호 (+ vs O)로 구분
  - 신용카드 사용량과 소득은 각각 독립변수, 연체 여부가 종속 변수

- 신용카드 사용량-소득 산점도 해석
  - 연체자(주황색 +)는 신용카드 사용량이 높은 구간에 집중적으로 분포
  - 연체가 없는 사람(파랑색 O)은 신용카드 사용량이 낮은 쪽에 주로 분포
  - 소득은 연체 여부와 뚜렷한 상관이 보이지 X
- 그룹별 분포(Boxplot)
  - 신용카드 사용량, 소득에 대해 연체의 그룹별 분포
- 그룹별 분포 해석

  - 신용카드 사용량 vs 연체

    > 연체자의 신용카드 사용량이 연체하지 않은 사람버디 전반적으로 높음
    > 중앙값도 높고, 분포가 퍼져 있는 정도도 더 큼

    - 소득 vs 연체
      > 연체 여부에 따른 소득 차이는 거의 없음

## 1-3. 분류 문제에 선형회귀를 써도 될까?

> 선형회귀는 분류 문제에 사용하기에 부적절함

1. 이진 분류 문제(예측 확률이 0보다 작거나 1보다 크게 예측될 수 있어 확률로 쓰기 부적절)
2. 다중 범주 문제
   - 정수형 코딩(1,2,3)에 따라 범주 간 순서와 동일한 거리를 가정
   - 범주(카테고리) 변수는 순서가 없는 라벨이미르 부적절함.

## 1-4. 분류 문제에서 적합한 모델

> 로지스틱 회귀

- 시그모이드 함수를 통해 0~1 사이의 범위 내 확률값 예측 보장
- 순서가 없는 범주를 확률로 직접 예측하는 적절한 방법

---

## 2. 로지스틱(Logistic) 회귀

## 2-1. 로지스틱 회귀의 모형식

- 기울어진 S자 형태의 곡선 함수
- `y = e\*\*z/(1+e\*\*2) = 1/(1+e\*\*-z), 이때 e는 오일러 수`
- 모든 실수 z에 대한 y값의 범위는 `0 <= y <= 1`이다.

  - z -> +무한대, y는 1로 수렴
  - z -> -무한대, y는 0으로 수렴

- 시그모이드 함수의 z에 선형회귀식 `z=b0+b1x` 식을 대입하면, 로지스틱 회귀의 모형식이 됨
- x와 베타 값과 상관없이 시그모이드 함수의 식의 결과값은 0~1 사이의 값만 나옴

## 2-2. 로지스틱 회귀 모형 vs 선형 모형

- 오즈(Odds)

  > 성공(y=1)확률이 실패(y=0)확률에 비해 몇 배 더 높은가를 나타냄
  > oods = 성공확률/실패확률

- 로짓 변환(logit) = Log odds
  > 로짓변환은 오즈(odds)에 log를 취한 함수 상태
  > logit(p) = logit(odds) = log(성공확률/실패확률) = b0 + b1x

=> 즉, 로직스틱 모형식은 선형 모형식과 시그모이드 함수의 결합이며, 로짓 변환시 선형 회귀 모형식으로 표현이 가능함

## 2-3. MLE 활용 모수 추정

> 확률을 계산하는 함수를 평가하기 위해선 우도를 지표로 삼음

- 우도(Likelihood) :
  "현재 확률 함수가 데이터를 얼마나 잘 설명하는지"를 나타낸 지표
- 우도 값을 높여 최대화가 되도록 하는 것이 목표; Maximum Likelihood Estimation(MLE)이라 함

- 로지스틱 회귀와 같은 이진 분류 문제에서 우도를 최대화 함
- 곱으로 이뤄진 함수의 경우 베타에 대해 미분이 어렵기 때문에 log를 취한 후 **log-likelihood**를 만들어 최대화 함
- 이후 미분하여 도함수=0에 근접하도록 수치적 최적화를 통해 베타들을 찾음

? log로 변형하여 문제를 접근해도 되는 것인가
-> Yes!, log 함수는 단조(monotone) 증가 함수이므로 가능하다

## 2-4. 로지스틱 회귀 결과: 신용카드 연체 데이터

입력 값 2배 증가 -> 예측 확률 값 97배 증가

---
