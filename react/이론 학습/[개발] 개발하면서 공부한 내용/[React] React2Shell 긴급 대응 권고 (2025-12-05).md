# ⚠️ React2Shell 긴급 대응 권고 (2025-12-05)

## 📌 목차
- [0. 핵심용어](#0-보안-용어-요약-표-키워드-정리)  
- [1. 개요](#1-개요--react2shell-cve-2025-55182)  
- [2. React2Shell 상세 설명](#2-react2shell-상세-설명)  
- [3. CVSS란](#3-cvss란)  
- [4. CVSS-100-의미](#4-cvss-100의-의미)  
- [5. 주요-cvss-100-사례](#5-주요-cvss-100-사례)  
- [6. 결론-및-권고사항](#6-결론-및-권고사항)

---

## 0. 보안 용어 요약 표 (키워드 정리)


| 용어 | 풀네임 | 뜻 / 설명 |
|------|---------|-----------|
| **RCE** | Remote Code Execution | 원격에서 공격자가 마음대로 코드 실행 가능하다는 뜻. 서버 장악 가능 수준이라 매우 위험함 |
| **RSC** | React Server Components | React 18에서 도입된 기능. 일부 컴포넌트를 서버에서 렌더링하고 필요한 정보만 클라이언트에 보내는 방식임 |
| **Flight 프로토콜** | Flight Protocol | RSC가 서버→클라이언트로 데이터를 보낼 때 사용하는 전송 포맷. 여기서 역직렬화 취약점 발생함 |
| **역직렬화(Deserialization)** | Deserialization | 문자열/바이너리를 객체로 되돌리는 과정. 입력 검증 부족하면 공격자가 악성 객체를 실행하게 만들 수 있음 |
| **PoC** | Proof of Concept | 취약점이 실제로 공격 가능한지 보여주는 ‘공격 테스트 코드’ 같은 것임 |
| **Exploit** | 공격 코드 | 취약점을 실제 공격에 사용 가능한 코드 |
| **CVSS** | Common Vulnerability Scoring System | 취약점의 심각도를 0~10점으로 평가하는 국제 표준 점수 |
| **무결성(Integrity)** | - | 데이터가 마음대로 변경되지 않는 성질. 깨지면 공격자가 DB와 서버 내용 아무거나 바꿀 수 있음 |
| **기밀성(Confidentiality)** | - | 민감한 데이터가 보호되어야 하는 성질. 깨지면 유출됨 |
| **가용성(Availability)** | - | 서비스가 정상 작동하는 상태. 깨지면 시스템 다운됨 |
| **내부망 이동(Lateral Movement)** | - | 서버 하나 뚫고 내부 네트워크까지 확산하는 공격 방법 |


---

## 1. 개요 — React2Shell (CVE-2025-55182)

- React.js / Next.js RSC(React Server Components)에서 사용되는 Flight 프로토콜 역직렬화 문제로 발생한 취약점임  
- 악성 HTTP 요청만 보내면 인증 없이 서버에서 임의 코드 실행 가능함(RCE)  
- Log4Shell 급으로 위험함  
- CVSS 점수 10.0 받음  

---

## 2. React2Shell 상세 설명

### 🛠 기술적 성격
- RSC는 서버와 클라이언트 사이 상태 전송 위해 Flight 프로토콜 사용함  
- 역직렬화 과정에서 입력 검증 부족함  
- 공격자가 Flight 스트림에 악성 데이터 섞어 보내면 서버가 그대로 역직렬화함  
- 결과적으로 공격자가 원하는 코드 서버에서 그대로 실행됨  

### 🧵 공격 시나리오
1. 공격자가 조작한 Flight 요청 전송  
2. 서버가 이를 정상 요청으로 처리  
3. 역직렬화 과정에서 악성 코드 실행됨  
4. 서버 장악 → 내부망 이동 공격 가능해짐  

---

## 3. CVSS란?

- **CVSS**는 취약점의 심각도 점수 매기는 국제 표준임  
- 점수는 0.0~10.0  
- 점수 높을수록 위험함  

### ⚡ CVSS 평가 요소

| 메트릭 | 설명 |
|-------|------|
| **Base** | 취약점 자체 위험도(난이도, 인증 여부, 영향도) |
| **Temporal** | 패치 여부, PoC 공개 여부 등 시간적 요소 |
| **Environmental** | 해당 조직 환경에서의 실제 영향도 |

---

## 4. CVSS 10.0의 의미

- CVSS **10.0 = 최고 위험도 Critical**  
- 사실상 “가장 위험한 취약점”에 해당함  

### 🔥 이런 조건 충족할 때 10점 나옴

| 조건 | 내용 |
|------|------|
| 원격 인증 필요 없음 | 로그인 없이 공격 가능 |
| 공격 난이도 매우 낮음 | 패킷 하나로 공격 가능 |
| 영향도 매우 큼 | 기밀·무결·가용성 모두 파괴 |
| 공격 코드 존재 가능성 높음 | PoC 나오면 대규모 피해 발생 |

React2Shell은 이 조건 대부분 충족함.

---

## 5. 주요 CVSS 10.0 사례

| 취약점 | 설명 |
|--------|------|
| **Log4Shell (Log4j)** | 문자열 하나로 RCE 가능. 전 세계 수억 대 서버 영향 |
| **EternalBlue** | SMB 취약점 → WannaCry 확산의 핵심 |
| **BlueKeep(9.8)** | 인증 없이 RDP에서 RCE 가능. 사실상 10급 위험도 |

---

## 6. 결론 및 권고사항

- React2Shell은 RSC 사용하는 모든 React/Next 서버에 매우 위험함  
- 즉시 패치 설치가 최우선  
- Flight 엔드포인트 외부 노출 여부 점검 필요  
- WAF에 Flight 프로토콜 관련 필터 적용 권장  
- RSC 관련 비정상 요청 로그 반드시 확인해야 함  

**요약:**  
React2Shell은 Log4Shell급 CVSS 10.0 원격 코드 실행 취약점임.  
React/Next 기반 서비스면 바로 조치해야 함.


--- 

### React/Next.js 취약점 테스트 & 프론트엔드 역할

## 7. 프론트엔드 개발자가 취약점이 우리 서비스에 영향을 주는지 확인하는 방법

### ✅ 프론트가 직접 할 수 있는 검증
- **의심되는 취약한 패키지 버전 확인**
  - `package.json`, `pnpm-lock.yaml` / `yarn.lock` / `package-lock.json`에서  
    React / Next.js / Vite / SWC / webpack 등 **취약점이 보고된 버전**인지 체크.
- **SSR·RSC·빌드 과정 확인**
  - 취약점이 SSR 또는 RSC 관련이라면,  
    서비스에서 **SSR 사용 여부**, **서버 컴포넌트 사용 여부**를 확인하여 영향 범위 좁힘.
- **PoC(개념증명) 입력 시도 (가능한 경우)**
  - 공식 보안 공지나 GitHub 이슈에서 제공된 **재현 가능한 입력 문자열**을  
    QA 환경에서 넣어 보고 오류 또는 예상 외 동작이 있는지 확인.
- **정적 분석 도구(SAST) 실행**
  - SonarQube, Snyk, GitHub Dependabot 등을 통해  
    패키지 기반 취약점 자동 탐지.

### ❌ 프론트엔드 단독으로는 거의 불가능한 부분
- 취약점 대부분이 **서버 런타임(SSR/RSC)** 또는 **빌드 파이프라인(swc/webpack/Vite)** 문제라  
  클라이언트 코드로 완전히 재현하기 어려움.
- 서버 메모리 접근, 경로 탈출(Path Traversal), RCE 같은 문제는  
  **서버 자체에서만 검증 가능**.

---

## 8. 프론트엔드가 즉시 할 수 있는 대응 & 패치

### ✅ 가능한 조치
- **패키지 업데이트 (가장 효과적)**
  - React / Next.js / SWC / webpack 등 취약한 버전을 최신 버전으로 즉시 업그레이드.
- **WAF차단 규칙 추가**
  - 취약점 관련 특정 입력 패턴 필터링(전사 보안팀 협업 필요).
- **코드 스플리팅, 민감 로직 분리 등 리스크 최소화**
  - 취약점이 빌드 도구나 SSR 단계에서 발생하는 경우  
    잠재적 공격 표면을 줄일 수 있음.

### ❌ 프론트가 직접 패치할 수 없는 부분
- 런타임 내부 엔진(swc, turbopack, webpack)의 취약점
- React 서버 컴포넌트 파서 또는 SSR 스트리밍 관련 취약점
- 메모리 오버플로우, 경로 탈출 등 **엔진 레벨 문제**

→ **결론:** 대부분의 *핵심 패치는 React/Next.js 팀이 해야 하는 영역*임.

---

## 9. 실제로 취약점 영향도 판단은 누가 하나?

### 🏢 기업 기준 역할 분담

| 역할 | 하는 일 |
|------|---------|
| **보안팀 / Security Engineer** | 취약점 CVE 분석, PoC 검증, 공격 가능한지 실환경 테스트, WAF 규칙 설정 |
| **DevOps / SRE** | 서버 환경 점검, 런타임 버전 업데이트, CD 파이프라인 패치 |
| **백엔드 개발자** | SSR 코드 영향점 분석, unsafe한 데이터 흐름 제거 |
| **프론트엔드 개발자** | 패키지 버전 확인·업데이트, 사용 여부 판단(SSR/RSC 사용 여부), 코드 내 위험한 입력 처리, 보안팀과 협업 |

### 📌 중요한 포인트
> React/Next.js 취약점은 대부분 **서버 런타임 또는 빌드 도구** 문제라  
> 프론트 혼자서 100% 해결할 수 없음.  
> 하지만 **영향 범위 파악 + 패치 적용 + 위험 최소화**는 프론트가 반드시 참여해야 함.

---

## 🎯 결론 한 줄 요약

- **프론트엔드가 직접 취약점을 “패치”하진 못한다.**  
- 하지만 **영향 분석 + 패키지 업데이트 + 코드 점검**은 프론트의 핵심 역할이다.  
- 실제 공격 가능 여부 검증은 **보안팀 + 백엔드 + SRE**가 함께 수행한다.

